import os
import sys
import cvxpy as cp
import numpy as np
import logging
import argparse
import random
import time
import copy

   
def update_tput(job, model_name):
        if 'alexnet' in model_name:
             job.tput = np.array([[0.2, 0.2, 0.2, 0.2],
                                   [0.4, 0.4, 0.4, 0.4],
                                   [0.5, 0.5, 0.5, 0.5],
                                   [0.6, 0.6, 0.6, 0.6],
                                   [0.7, 0.7, 0.7, 0.7],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.5, 1.5, 1.5, 1.5] ])
        elif 'res18' in model_name:
             job.tput = np.array([[0.2, 0.2, 0.2, 0.2],
                                   [0.4, 0.4, 0.4, 0.4],
                                   [0.5, 0.5, 0.5, 0.5],
                                   [0.55, 0.55, 0.55, 0.55],
                                   [0.6, 0.6, 0.6, 0.6],
                                   [0.9, 0.9, 0.9, 0.9],
                                   [1.0, 1.0, 1.0, 1.0] ])
        elif 'res50' in model_name and job.job_gpu_demand == 1:
             job.tput = np.array([[0.2, 0.2, 0.2, 0.2],
                                   [0.6, 0.6, 0.6, 0.6],
                                   [0.9, 0.9, 0.9, 0.9],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0] ])
        elif 'res50' in model_name and job.job_gpu_demand == 2:
             job.tput = np.array([[0.2, 0.2, 0.2, 0.2],
                                   [0.6, 0.6, 0.6, 0.6],
                                   [0.8, 0.8, 0.8, 0.8],
                                   [0.85, 0.85, 0.85, 0.85],
                                   [0.9, 0.9, 0.9, 0.9],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.1, 1.1, 1.1, 1.1] ])
        elif 'shuffle' in model_name:
             job.tput = np.array([[0.2, 0.2, 0.2, 0.2],
                                   [0.4, 0.4, 0.4, 0.4],
                                   [0.5, 0.5, 0.5, 0.5],
                                   [0.6, 0.6, 0.6, 0.6],
                                   [0.7, 0.7, 0.7, 0.7],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.5, 1.5, 1.5, 1.5] ])
        elif 'mobile' in model_name:
             job.tput = np.array([[0.2, 0.2, 0.2, 0.2],
                                   [0.4, 0.4, 0.4, 0.4],
                                   [0.5, 0.5, 0.5, 0.5],
                                   [0.55, 0.55, 0.55, 0.55],
                                   [0.6, 0.6, 0.6, 0.6],
                                   [0.9, 0.9, 0.9, 0.9],
                                   [1.0, 1.0, 1.0, 1.0] ])
        elif job.job_gpu_demand == 1:
             job.tput = np.array([[1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0] ])
        else:
            job.tput = np.array([[0.6, 0.6, 0.6, 0.6],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0],
                                   [1.0, 1.0, 1.0, 1.0] ])


def get_idx(val):
    cpu_val = {0:1, 1:2, 2:3, 3:4, 4:5, 5:6, 6:12, 7:8}
    for k, v in cpu_val.items():
        if val == v:
            return k
    print("returning None for {}".format(val))
    return None
